# ASL 前端代码集成到 sysafari-logistics 系统指南

## 文件说明

这些文件是已经编译打包好的前端应用文件，基于 **umi** 框架（Ant Design Pro）构建。包含以下内容：

### 主要文件类型

1. **入口文件**
   - `umi.js` - 主 JavaScript 入口文件
   - `umi.css` - 主样式文件

2. **代码分割文件（Chunks）**
   - `*.js` - JavaScript 代码块文件
   - `*.chunk.css` - CSS 样式块文件

3. **页面组件文件**
   - `p__user__Login.js` - 登录页面
   - `p__Bill__index.js` - 账单管理页面
   - `p__Packages__index.js` - 包裹管理页面
   - `p__Labels__index.js` - 标签管理页面
   - `p__Declaration__index.js` - 申报管理页面
   - `p__LastMile__UserIndex.js` - 最后里程管理页面
   - `p__SySafariView__ManageIndex.js` - Sysafari 视图管理页面
   - `p__Profile__index.js` - 个人资料页面
   - `t__plugin-layout__Layout.js` - 布局组件

## 集成步骤

### 方案一：作为静态文件部署（推荐）

#### 1. 文件部署

将所有文件复制到 web 服务器的静态资源目录：

```bash
# 示例：Nginx 部署
/var/www/sysafari-logistics/
├── index.html          # 需要创建（见下方）
├── umi.js
├── umi.css
├── *.js
├── *.chunk.css
└── ...
```

#### 2. 创建 index.html

创建 `index.html` 文件作为应用入口：

```html
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no" />
    <meta name="theme-color" content="#000000" />
    <title>Sysafari Logistics - ASL</title>
    <link rel="stylesheet" href="/umi.css" />
    <script>
        window.routerBase = "/";
        window.publicPath = "/";
    </script>
</head>
<body>
    <div id="root"></div>
    <script src="/umi.js"></script>
</body>
</html>
```

#### 3. Nginx 配置示例

```nginx
server {
    listen 80;
    server_name sysafari-logistics.example.com;
    root /var/www/sysafari-logistics;
    index index.html;

    # 静态文件缓存
    location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
    }

    # 前端路由支持（SPA）
    location / {
        try_files $uri $uri/ /index.html;
    }

}
```

### 方案二：集成到现有项目

#### 1. 如果已有 umi 项目

将文件复制到 `dist/` 目录：

```bash
# 假设现有项目结构
your-project/
├── dist/              # 构建输出目录
│   ├── index.html
│   ├── umi.js
│   ├── umi.css
│   └── ...
```

#### 2. 如果使用其他框架

需要创建一个 HTML 文件来加载这些资源，并确保：
- 所有文件路径正确
- 支持前端路由（History API）

### 方案三：Docker 部署

创建 `Dockerfile`：

```dockerfile
FROM nginx:alpine

# 复制静态文件
COPY . /usr/share/nginx/html/

# 复制 Nginx 配置
COPY nginx.conf /etc/nginx/conf.d/default.conf

EXPOSE 80

CMD ["nginx", "-g", "daemon off;"]
```

创建 `nginx.conf`：

```nginx
server {
    listen 80;
    root /usr/share/nginx/html;
    index index.html;

    location / {
        try_files $uri $uri/ /index.html;
    }

}
```

构建和运行：

```bash
docker build -t sysafari-logistics-frontend .
docker run -d -p 80:80 sysafari-logistics-frontend
```

## 配置说明

### 1. 路由配置

应用使用前端路由，确保：
- Web 服务器配置了 SPA 路由支持（所有路由返回 index.html）
- 路由基础路径配置正确（`window.routerBase`）

## 功能模块

根据文件名，应用包含以下功能模块：

1. **用户认证**
   - 登录 (`p__user__Login`)
   - 个人资料 (`p__Profile__index`)

2. **业务管理**
   - 账单管理 (`p__Bill__index`)
   - 包裹管理 (`p__Packages__index`)
   - 标签管理 (`p__Labels__index`)
   - 申报管理 (`p__Declaration__index`)
   - 最后里程管理 (`p__LastMile__UserIndex`)

3. **系统管理**
   - Sysafari 视图管理 (`p__SySafariView__ManageIndex`)

## 注意事项

1. **文件完整性**
   - 确保所有文件都已复制，不要遗漏任何 chunk 文件
   - 文件之间的依赖关系由 webpack 管理

2. **路径配置**
   - 确保所有资源文件的路径正确
   - 如果部署在子目录，需要配置 `publicPath`

3. **浏览器兼容性**
   - 这些文件可能需要现代浏览器支持
   - 建议使用 Chrome、Firefox、Safari 或 Edge 最新版本

4. **缓存策略**
   - 建议对静态资源设置长期缓存
   - 对 `index.html` 不设置缓存或设置短期缓存

## 验证部署

部署后，访问应用并检查：

1. 页面是否正常加载
2. 样式是否正确显示
3. 路由跳转是否正常
4. 控制台是否有错误

## 故障排查

### 问题：页面空白
- 检查浏览器控制台错误
- 确认所有 JS/CSS 文件路径正确
- 检查网络请求是否成功

### 问题：路由 404
- 确认服务器配置了 SPA 路由支持
- 检查 `window.routerBase` 配置

## 联系支持

如有问题，请检查：
1. 浏览器控制台错误信息
2. 服务器访问日志

